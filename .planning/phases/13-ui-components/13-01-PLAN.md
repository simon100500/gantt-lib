---
wave: 1
depends_on: []
files_modified:
  - packages/gantt-lib/package.json
  - packages/gantt-lib/src/components/ui/Input.tsx
  - packages/gantt-lib/src/components/ui/Button.tsx
  - packages/gantt-lib/src/components/ui/Calendar.tsx
  - packages/gantt-lib/src/components/ui/Popover.tsx
  - packages/gantt-lib/src/components/ui/DatePicker.tsx
  - packages/gantt-lib/src/components/ui/index.ts
  - packages/gantt-lib/src/components/TaskList/TaskListRow.tsx
  - packages/gantt-lib/src/components/TaskList/TaskList.css
autonomous: true
---

# Phase 13-01: shadcn/ui Components — DatePicker and Input

## Goal

Replace native `<input type="date">` and plain `<input type="text">` in TaskList with styled shadcn/ui-based components (DatePicker and Input) for consistent, cross-browser beautiful UI with minimal bundle size impact.

## Requirements

None — internal UX improvement

## Success Criteria

1. shadcn/ui components copied into `packages/gantt-lib/src/components/ui/`
2. Dependencies installed: `react-day-picker`, `@radix-ui/react-popover`
3. TaskListRow uses new Input and DatePicker components
4. Components styled with CSS variables matching gantt-lib theme
5. Bundle size increase < 30KB gzipped
6. Components work across browsers (Chrome, Firefox, Safari, Edge)

## Tasks

### Task 1: Install dependencies

**Action**: Add required npm packages for DatePicker and Input components

**Implementation details**:
```bash
cd packages/gantt-lib
pnpm add react-day-picker @radix-ui/react-popover
pnpm add -D @types/react-day-picker
```

**Verification**:
- `react-day-picker` appears in dependencies
- `@radix-ui/react-popover` appears in dependencies
- `pnpm install` completes without errors

### Task 2: Create base UI components (shadcn/ui copy-paste)

**Action**: Create shadcn/ui-inspired components in the library

**Implementation details**:

Create `packages/gantt-lib/src/components/ui/` directory with:

1. **Input.tsx** - Styled text input
   - Forward ref, accepts standard input props
   - CSS variables: `--gantt-input-bg`, `--gantt-input-border`, `--gantt-input-focus-ring`
   - Supports variants: default, error (optional)

2. **Button.tsx** - Simple button (for calendar navigation)
   - Radix-based or lightweight custom
   - CSS variables for theming

3. **Popover.tsx** - Radix Popover wrapper
   - Wraps `@radix-ui/react-popover`
   - Portal option for z-index safety

4. **Calendar.tsx** - react-day-picker wrapper
   - Wraps `react-day-picker` (DayPicker component from `react-day-picker` v8)
   - Custom styling via CSS modules or inline styles
   - Props: mode, selected, onSelect, disabled, etc.

5. **DatePicker.tsx** - Combined Popover + Calendar
   - Input field that shows calendar on click
   - Formats dates using existing `date-fns` (already in project)
   - Handles ISO date strings (YYYY-MM-DD)

Create `packages/gantt-lib/src/components/ui/index.ts` exporting all components

**Verification**:
- All component files exist
- TypeScript compiles without errors
- Components are exported from index.ts

### Task 3: Create UI component styles

**Action**: Create CSS for UI components with gantt-lib theming

**Implementation details**:

Create `packages/gantt-lib/src/components/ui/ui.css` with:

```css
/* CSS Variables for UI components */
:root {
  --gantt-input-bg: #ffffff;
  --gantt-input-border: #d1d5db;
  --gantt-input-focus-ring: rgba(59, 130, 246, 0.5);
  --gantt-input-text: #1f2937;
  --gantt-input-placeholder: #9ca3af;
  --gantt-input-radius: 6px;

  --gantt-popover-bg: #ffffff;
  --gantt-popover-border: #e5e7eb;
  --gantt-popover-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);

  --gantt-calendar-day-hover: #f3f4f6;
  --gantt-calendar-day-selected: #3b82f6;
  --gantt-calendar-day-selected-text: #ffffff;
  --gantt-calendar-day-today: #eff6ff;
  --gantt-calendar-day-outside: #f9fafb;
  --gantt-calendar-day-disabled: #e5e7eb;
}

/* Input base styles */
.gantt-input {
  display: flex;
  height: 32px;
  width: 100%;
  border-radius: var(--gantt-input-radius);
  border: 1px solid var(--gantt-input-border);
  background-color: var(--gantt-input-bg);
  padding: 0 8px;
  font-size: 0.85rem;
  color: var(--gantt-input-text);
  transition: border-color 150ms, box-shadow 150ms;
}

.gantt-input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 2px var(--gantt-input-focus-ring);
}

.gantt-input::placeholder {
  color: var(--gantt-input-placeholder);
}

/* Popover styles */
.gantt-popover {
  background: var(--gantt-popover-bg);
  border: 1px solid var(--gantt-popover-border);
  border-radius: 8px;
  box-shadow: var(--gantt-popover-shadow);
  padding: 4px;
  z-index: 1000;
}

/* Calendar styles (react-day-picker class overrides) */
.gantt-calendar {
  display: flex;
  flex-direction: column;
}

.gantt-calendar-month {
  display: flex;
  flex-direction: column;
}

.gantt-calendar-month-caption {
  display: flex;
  justify-content: center;
  padding: 8px 0;
  font-size: 0.9rem;
  font-weight: 500;
}

.gantt-calendar-months {
  display: flex;
  gap: 16px;
}

.gantt-calendar-week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
}

.gantt-calendar-day {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 32px;
  width: 32px;
  border-radius: 6px;
  font-size: 0.85rem;
  cursor: pointer;
  transition: background-color 100ms;
}

.gantt-calendar-day:hover:not([disabled]):not(.gantt-calendar-day-selected) {
  background-color: var(--gantt-calendar-day-hover);
}

.gantt-calendar-day-selected {
  background-color: var(--gantt-calendar-day-selected);
  color: var(--gantt-calendar-day-selected-text);
  font-weight: 500;
}

.gantt-calendar-day-today {
  background-color: var(--gantt-calendar-day-today);
}

.gantt-calendar-day-outside {
  color: var(--gantt-calendar-day-outside);
}

.gantt-calendar-day-disabled {
  color: var(--gantt-calendar-day-disabled);
  cursor: not-allowed;
}

.gantt-calendar-weekday {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 28px;
  font-size: 0.75rem;
  font-weight: 500;
  color: #6b7280;
}

.gantt-calendar-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 8px;
}
```

Import in `packages/gantt-lib/src/index.ts` or component files as needed

**Verification**:
- ui.css file exists with all styles
- CSS variables are defined
- Styles use `gantt-` prefix

### Task 4: Integrate Input and DatePicker into TaskListRow

**Action**: Replace native inputs with new UI components

**Implementation details**:

Modify `packages/gantt-lib/src/components/TaskList/TaskListRow.tsx`:

```tsx
import { Input } from '../ui/Input';
import { DatePicker } from '../ui/DatePicker';

// Replace name input overlay with Input component
<Input
  value={nameValue}
  onChange={(e) => setNameValue(e.target.value)}
  onBlur={handleNameSave}
  onKeyDown={handleNameKeyDown}
  className="gantt-tl-name-input"
/>

// Replace date inputs with DatePicker
<DatePicker
  value={task.startDate}
  onChange={(newDate) => handleStartDateChange({ target: { value: newDate } })}
  format="dd.MM.yyyy"
  className="gantt-tl-date-picker"
/>
```

Update `packages/gantt-lib/src/components/TaskList/TaskList.css`:
- Remove `.gantt-tl-input-overlay` styles (use Input component styles)
- Remove `.gantt-tl-date-picker` transparent overlay (use DatePicker)
- Add alignment styles for new components

**Verification**:
- TaskListRow imports and uses Input and DatePicker
- Name editing works with new Input component
- Date editing works with DatePicker (calendar appears on click)
- Styles match existing gantt-lib design

### Task 5: Update library exports

**Action**: Export new UI components from library

**Implementation details**:

Modify `packages/gantt-lib/src/index.ts`:
```tsx
export { Input } from './components/ui/Input';
export { DatePicker } from './components/ui/DatePicker';
export { Calendar } from './components/ui/Calendar';
export { Popover } from './components/ui/Popover';
export { Button } from './components/ui/Button';
```

**Verification**:
- Components can be imported from 'gantt-lib'
- TypeScript types are exported
- No export errors

## Files Modified

- `packages/gantt-lib/package.json` - MODIFIED (add dependencies)
- `packages/gantt-lib/src/components/ui/Input.tsx` - NEW
- `packages/gantt-lib/src/components/ui/Button.tsx` - NEW
- `packages/gantt-lib/src/components/ui/Calendar.tsx` - NEW
- `packages/gantt-lib/src/components/ui/Popover.tsx` - NEW
- `packages/gantt-lib/src/components/ui/DatePicker.tsx` - NEW
- `packages/gantt-lib/src/components/ui/index.ts` - NEW
- `packages/gantt-lib/src/components/ui/ui.css` - NEW
- `packages/gantt-lib/src/components/TaskList/TaskListRow.tsx` - MODIFIED
- `packages/gantt-lib/src/components/TaskList/TaskList.css` - MODIFIED
- `packages/gantt-lib/src/index.ts` - MODIFIED
- `packages/website/src/app/page.tsx` - MODIFIED (demo/test new components)

## Must Haves

1. Dependencies installed successfully
2. All UI components created and compile without errors
3. DatePicker shows calendar popup on click
4. DatePicker accepts and returns ISO date strings (YYYY-MM-DD)
5. Input component supports all standard input props
6. Components use CSS variables for theming
7. TaskList name editing works with new Input
8. TaskList date editing works with new DatePicker
9. Styles match gantt-lib design (colors, spacing, fonts)
10. Bundle size increase is acceptable (< 30KB gzipped)

## Verification Criteria

After executing this plan, the following should be TRUE:

1. [ ] `pnpm install` completes without errors
2. [ ] `pnpm build` completes without errors
3. [ ] Input component renders correctly
4. [ ] DatePicker component renders correctly
5. [ ] Clicking DatePicker input opens calendar popup
6. [ ] Selecting a date in calendar updates the input value
7. [ ] DatePicker displays dates in DD.MM.YYYY format (Russian locale)
8. [ ] DatePicker value is stored as YYYY-MM-DD ISO format
9. [ ] TaskList name edit mode shows styled Input
10. [ ] TaskList date edit mode shows styled DatePicker
11. [ ] Calendar navigation (month prev/next) works
12. [ ] Calendar highlights today's date
13. [ ] Calendar highlights selected date
14. [ ] Components are exported from 'gantt-lib' package
15. [ ] Visual inspection: components look consistent with gantt-lib design

## Dependencies

None (first plan of Phase 13)

## Notes

- This plan copies shadcn/ui component patterns directly into the library rather than using shadcn CLI
- react-day-picker v8+ uses hooks (useNavigation, useDayPicker) - ensure compatibility
- DatePicker should reuse existing `date-fns` utilities from `packages/gantt-lib/src/utils/dateUtils.ts`
- All UI components use `gantt-` prefix for CSS classes to avoid conflicts
- Consider adding `className` prop support to all components for user customization
- Popover portal can be disabled for TaskList (z-index handled by parent)

## Estimated Bundle Impact

- `react-day-picker`: ~16KB gzipped
- `@radix-ui/react-popover`: ~3KB gzipped
- Component code: ~5KB gzipped
- **Total: ~24KB gzipped**
